    *{margin:0;padding:0;box-sizing:border-box}
    :root{
        --bg:#090b10;--bg2:#0f1218;--card:#151921;--card2:#1a1f2b;
        --brd:#252a36;--brd2:#363d4e;
        --text:#e4e8f1;--text2:#8892a6;--text3:#5d6577;
        --accent:#7c6aff;--accent2:#6555e0;--accent-g:linear-gradient(135deg,#7c6aff,#5a45e0);
        --green:#2dd4a0;--green-bg:rgba(45,212,160,.08);--green-brd:rgba(45,212,160,.2);
        --red:#ff5c6a;--red-bg:rgba(255,92,106,.08);
        --orange:#ffa94d;--blue:#5eaeff;
        --radius:14px;--radius-sm:10px;
        --shadow:0 4px 24px rgba(0,0,0,.35);
    }
    html{height:100%}
    body{
        font-family:'Tajawal','Segoe UI',sans-serif;
        background:var(--bg);color:var(--text);
        height:100%;display:flex;flex-direction:column;
        -webkit-font-smoothing:antialiased;
    }
    /* HEADER */
    .header{
        background:linear-gradient(180deg,var(--card) 0%,var(--bg2) 100%);
        border-bottom:1px solid var(--brd);
        padding:12px 24px;display:flex;align-items:center;justify-content:space-between;
        position:sticky;top:0;z-index:100;
    }
    .header-right{display:flex;align-items:center;gap:14px}
    .logo{font-size:1.25rem;font-weight:700;display:flex;align-items:center;gap:8px}
    .logo svg{width:28px;height:28px}
    .version{background:var(--accent);color:#fff;padding:2px 9px;border-radius:20px;font-size:.65rem;font-weight:700;letter-spacing:.5px}
    .status-dot{width:9px;height:9px;border-radius:50%;display:inline-block;box-shadow:0 0 6px currentColor}
    .status-dot.on{background:var(--green);color:var(--green)}
    .status-dot.off{background:var(--red);color:var(--red)}
    .status-label{font-size:.78rem;color:var(--text2);display:flex;align-items:center;gap:5px}
    .header-left{display:flex;align-items:center;gap:8px}
    .btn-sm{
        background:var(--card2);border:1px solid var(--brd);color:var(--text2);
        padding:5px 12px;border-radius:8px;font-size:.78rem;cursor:pointer;
        text-decoration:none;display:inline-flex;align-items:center;gap:5px;
        transition:all .2s;font-family:inherit;
    }
    .btn-sm:hover{border-color:var(--accent);color:var(--accent);background:rgba(124,106,255,.06)}
    .btn-sm.lang-active{background:var(--accent);color:#fff;border-color:var(--accent)}
    /* CHAT AREA */
    .chat-wrap{flex:1;overflow-y:auto;padding:20px 0;scroll-behavior:smooth}
    .chat-inner{max-width:800px;margin:0 auto;padding:0 20px;display:flex;flex-direction:column;gap:6px}
    .msg{display:flex;gap:10px;max-width:88%;animation:fadeUp .35s ease}
    .msg.user{align-self:flex-end;flex-direction:row-reverse}
    .msg.bot{align-self:flex-start}
    @keyframes fadeUp{from{opacity:0;transform:translateY(8px)}to{opacity:1;transform:translateY(0)}}
    .avatar{width:36px;height:36px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:1rem;flex-shrink:0}
    .msg.user .avatar{background:var(--accent);color:#fff}
    .msg.bot .avatar{background:var(--green);color:#000;font-size:1.1rem}
    .bubble{padding:12px 16px;border-radius:var(--radius);line-height:1.75;font-size:.92rem;white-space:pre-wrap;word-break:break-word}
    .msg.user .bubble{background:var(--accent2);color:#fff;border-bottom-right-radius:4px}
    [dir=rtl] .msg.user .bubble{border-bottom-right-radius:4px;border-bottom-left-radius:var(--radius)}
    .msg.bot .bubble{background:var(--card2);border:1px solid var(--brd);border-bottom-left-radius:4px}
    [dir=rtl] .msg.bot .bubble{border-bottom-left-radius:4px;border-bottom-right-radius:var(--radius)}
    .sources-panel{margin-top:8px;padding:10px 14px;border-radius:var(--radius-sm);background:rgba(124,106,255,.05);border:1px solid rgba(124,106,255,.12)}
    .sources-title{color:var(--accent);font-weight:700;font-size:.8rem;margin-bottom:6px}
    .src-item{font-size:.78rem;color:var(--text2);padding:4px 0;border-bottom:1px solid rgba(255,255,255,.03)}
    .src-item:last-child{border:0}
    .score{display:inline-block;background:var(--accent);color:#fff;padding:1px 7px;border-radius:20px;font-size:.65rem;font-weight:700;margin-inline-end:4px}
    .meta-row{display:flex;gap:6px;flex-wrap:wrap;margin-top:6px}
    .chip{background:rgba(255,255,255,.04);border:1px solid var(--brd);padding:2px 9px;border-radius:20px;font-size:.68rem;color:var(--text3);display:inline-flex;align-items:center;gap:3px}
    /* WELCOME */
    .welcome{text-align:center;padding:60px 20px}
    .welcome-icon{font-size:3.2rem;margin-bottom:12px;animation:float 3s ease-in-out infinite}
    @keyframes float{0%,100%{transform:translateY(0)}50%{transform:translateY(-8px)}}
    .welcome h2{font-size:1.3rem;margin-bottom:8px;font-weight:700}
    .welcome p{color:var(--text2);max-width:460px;margin:0 auto 20px;line-height:1.7;font-size:.9rem}
    .suggestions{display:flex;flex-wrap:wrap;gap:8px;justify-content:center}
    .sug-btn{background:var(--card2);border:1px solid var(--brd);color:var(--text);padding:8px 18px;border-radius:24px;cursor:pointer;font-size:.82rem;transition:all .2s;font-family:inherit}
    .sug-btn:hover{border-color:var(--accent);background:rgba(124,106,255,.08);transform:translateY(-1px)}
    /* ERROR */
    .error-box{background:var(--red-bg);border:1px solid rgba(255,92,106,.2);color:var(--red);padding:12px 16px;border-radius:var(--radius-sm);font-size:.88rem;text-align:center;max-width:600px;margin:10px auto}
    /* INPUT BAR */
    .input-bar{background:var(--card);border-top:1px solid var(--brd);padding:14px 20px}
    .input-inner{max-width:800px;margin:0 auto}
    .attach-row{display:flex;gap:8px;margin-bottom:8px;flex-wrap:wrap;align-items:center}
    .attach-tag{display:none;align-items:center;gap:4px;background:rgba(124,106,255,.1);border:1px solid rgba(124,106,255,.18);padding:4px 10px;border-radius:20px;font-size:.75rem;color:var(--accent)}
    .attach-tag.show{display:inline-flex}
    .attach-tag .remove{cursor:pointer;margin-inline-end:4px;opacity:.6}
    .attach-tag .remove:hover{opacity:1}
    .form-row{display:flex;gap:8px;align-items:flex-end}
    /* Attachment dropdown */
    .attach-menu{position:relative;display:inline-flex;align-items:flex-end;padding-bottom:1px}
    .attach-toggle{width:44px;height:44px;border-radius:10px;border:1px solid var(--brd);background:var(--card2);color:var(--text2);cursor:pointer;display:flex;align-items:center;justify-content:center;font-size:1.15rem;transition:all .2s;flex-shrink:0}
    .attach-toggle:hover,.attach-toggle.open{background:var(--accent);color:#fff;border-color:var(--accent)}
    .attach-dropdown{display:none;position:absolute;bottom:calc(100% + 8px);left:0;background:var(--card2);border:1px solid var(--brd2);border-radius:12px;padding:6px;box-shadow:0 8px 28px rgba(0,0,0,.5);z-index:200;min-width:165px}
    [dir=rtl] .attach-dropdown{left:auto;right:0}
    .attach-dropdown.show{display:block}
    .adrop-item{display:flex;align-items:center;gap:9px;width:100%;padding:10px 14px;background:none;border:none;color:var(--text);font-size:.9rem;cursor:pointer;border-radius:8px;text-align:start;font-family:inherit;transition:background .15s}
    .adrop-item:hover{background:rgba(124,106,255,.12);color:var(--accent)}
    .adrop-item.active{color:var(--green)}
    .adrop-item.recording{color:var(--red);animation:pulse 1s ease-in-out infinite}
    @keyframes pulse{0%,100%{box-shadow:0 0 0 0 rgba(255,92,106,.4)}50%{box-shadow:0 0 0 6px rgba(255,92,106,0)}}
    input[type="file"]{display:none}
    .textarea-wrap{flex:1;position:relative}
    .textarea-wrap textarea{width:100%;background:var(--bg2);border:2px solid var(--brd);border-radius:var(--radius);padding:13px 16px;color:var(--text);font-size:.95rem;font-family:inherit;resize:none;outline:none;transition:border-color .3s;min-height:48px;max-height:140px}
    .textarea-wrap textarea:focus{border-color:var(--accent)}
    .textarea-wrap textarea::placeholder{color:var(--text3)}
    .send-btn{background:var(--accent-g);border:none;width:48px;height:48px;border-radius:var(--radius);cursor:pointer;display:flex;align-items:center;justify-content:center;color:#fff;font-size:1.2rem;transition:transform .15s,box-shadow .15s;flex-shrink:0;align-self:flex-end}
    .send-btn:hover{transform:scale(1.06);box-shadow:0 4px 18px rgba(124,106,255,.35)}
    .send-btn:active{transform:scale(.95)}
    .send-btn:disabled{opacity:.4;cursor:not-allowed;transform:none;box-shadow:none}
    .spinner{display:none;width:20px;height:20px;border:2px solid rgba(255,255,255,.2);border-top-color:#fff;border-radius:50%;animation:spin .6s linear infinite}
    @keyframes spin{to{transform:rotate(360deg)}}
    .sending .spinner{display:block}
    .sending .send-icon{display:none}
    .health-strip{background:var(--card);border-bottom:1px solid var(--brd);padding:6px 20px;font-size:.72rem;color:var(--text3);display:flex;align-items:center;justify-content:center;gap:16px}
    .health-strip .hs-item{display:flex;align-items:center;gap:4px}
    @media(max-width:640px){
        .header{padding:10px 14px}
        .logo{font-size:1rem}
        .version{display:none}
        .status-label{font-size:.7rem}
        .chat-inner{padding:0 10px}
        .msg{max-width:96%}
        .bubble{padding:10px 13px;font-size:.88rem}
        .input-bar{padding:10px 10px 14px}
        .form-row{flex-wrap:wrap;gap:5px}
        .send-btn{width:44px;height:44px;align-self:flex-end}
        .textarea-wrap{flex:1;min-width:0}
        .welcome{padding:28px 14px}
        .welcome-icon{font-size:2.4rem}
        .sug-btn{font-size:.78rem;padding:7px 12px}
        .header-left{gap:4px}
        .btn-sm{padding:4px 8px;font-size:.72rem}
        .meta-row{gap:3px}
        .chip{font-size:.63rem;padding:2px 7px}
        .health-strip{font-size:.68rem;gap:10px}
    }
    /* ── Markdown rendered content ── */
    .md-content{white-space:normal}
    .md-content p{margin-bottom:.6em}
    .md-content p:last-child{margin-bottom:0}
    .md-content code{background:rgba(255,255,255,.08);padding:2px 6px;border-radius:4px;font-size:.85em;font-family:'Consolas','Courier New',monospace}
    .md-content pre{background:#0d1117;border:1px solid var(--brd);border-radius:8px;padding:12px 16px;overflow-x:auto;margin:.5em 0}
    .md-content pre code{background:none;padding:0;font-size:.82rem;color:#e6edf3}
    .md-content ul,.md-content ol{padding-inline-start:1.4em;margin:.4em 0}
    .md-content li{margin:.25em 0}
    .md-content strong{color:var(--text);font-weight:700}
    .md-content h1,.md-content h2,.md-content h3{margin:.5em 0 .3em;color:var(--accent)}
    .md-content table{width:100%;border-collapse:collapse;margin:.5em 0;font-size:.82rem}
    .md-content th,.md-content td{border:1px solid var(--brd);padding:7px 12px;text-align:start}
    .md-content th{background:rgba(255,255,255,.04);font-weight:600}
    .md-content blockquote{border-inline-start:3px solid var(--accent);padding:.3em .8em;margin:.4em 0;color:var(--text2)}
    .md-content a{color:var(--accent)}
    .mermaid{background:#0d1117;border-radius:8px;padding:14px;margin:.5em 0;overflow-x:auto;text-align:center}
    ::-webkit-scrollbar{width:5px}
    ::-webkit-scrollbar-track{background:transparent}
    ::-webkit-scrollbar-thumb{background:var(--brd);border-radius:10px}
    /* OCR preview (shown below attach tags before sending) */
    .ocr-preview{width:100%;background:rgba(45,212,160,.06);border:1px solid rgba(45,212,160,.18);border-radius:10px;padding:8px 12px;margin-top:6px}
    .ocr-status{font-size:.75rem;color:var(--green);margin-bottom:4px;font-weight:600}
    .ocr-extracted{font-size:.75rem;color:var(--text2);white-space:pre-wrap;word-break:break-word;max-height:80px;overflow-y:auto;margin:0;font-family:inherit}
    /* Extracted text block inside the sent user bubble */
    .ocr-block{margin-top:8px;background:rgba(255,255,255,.04);border:1px solid var(--brd);border-radius:8px;padding:6px 10px;font-size:.75rem}
    .ocr-block summary{cursor:pointer;color:var(--accent);font-weight:600;list-style:none;outline:none}
    .ocr-block summary::before{content:'▶ ';font-size:.65rem}
    .ocr-block[open] summary::before{content:'▼ '}
    .ocr-block-text{margin-top:6px;color:var(--text2);white-space:pre-wrap;word-break:break-word;max-height:120px;overflow-y:auto;font-family:inherit;line-height:1.6}
