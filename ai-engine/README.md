# نظام الذكاء الاصطناعي (AI System) - توثيق الجداول

**الإصدار الحالي:** 1.0 (فبراير 2026)  
**قاعدة البيانات:** MySQL 8.4+ (Community) أو PostgreSQL + pgvector (موصى به للبحث الدلالي)  
**الغرض:** دعم نظام محادثات شبيه ChatGPT مع دعم RAG (Retrieval-Augmented Generation)، رفع ملفات، ذاكرة محادثات، تحليل صور/OCR، تقييم ردود، وسجل استخدام.

## نظرة عامة على الجداول

| الجدول                     | الغرض الرئيسي                              | يحتوي على embeddings؟ | متعدد المستأجرين؟ | متعدد المستخدمين؟ |
|----------------------------|---------------------------------------------|--------------------------|---------------------|---------------------|
| `ai_knowledge_bases`       | مجموعات المعرفة / Knowledge Bases          | لا                       | نعم (مستقبلي)      | نعم                 |
| `ai_documents`             | الوثائق / المصادر داخل كل Knowledge Base   | لا                       | نعم                 | نعم                 |
| `ai_document_chunks`       | المقاطع النصية + التضمينات (Embeddings)   | **نعم**                  | نعم                 | نعم                 |
| `ai_threads`               | المحادثات / Threads                        | لا                       | نعم                 | نعم                 |
| `ai_messages`              | الرسائل داخل كل محادثة                     | لا                       | نعم                 | نعم                 |
| `ai_thread_memory`         | ملخص وذاكرة طويلة الأمد لكل محادثة       | لا                       | نعم                 | نعم                 |
| `ai_files`                 | الملفات المرفوعة (pdf, doc, jpg, png...)   | لا                       | نعم                 | نعم                 |
| `ai_message_files`         | ربط الملفات بالرسائل (many-to-many)        | لا                       | نعم                 | نعم                 |
| `ai_vision_analyses`       | نتائج OCR / تحليل الصور / Vision           | نعم (اختياري)           | نعم                 | نعم                 |
| `ai_feedback`              | تقييمات المستخدمين للردود                 | لا                       | نعم                 | نعم                 |
| `ai_usage_logs`            | سجل استهلاك الـ tokens والتكلفة           | لا                       | نعم                 | نعم                 |

## تفصيل كل جدول

### 1. ai_knowledge_bases

مجموعات المعرفة (مثل "وثائق الشركة"، "أسئلة شائعة"، "كتالوج المنتجات"...)

| حقل           | النوع         | NULL؟ | افتراضي          | وصف                                                                 |
|---------------|---------------|-------|-------------------|---------------------------------------------------------------------|
| id            | CHAR(36)      | لا    | —                 | المعرف الفريد (UUID كـ string)                                     |
| name          | VARCHAR(255)  | لا    | —                 | اسم المجموعة (مطلوب)                                              |
| description   | TEXT          | نعم   | NULL              | وصف مختصر للمجموعة                                                |
| is_public     | TINYINT(1)    | نعم   | 0                 | هل يمكن للمستخدمين الآخرين الوصول إليها؟                        |
| metadata      | JSON          | نعم   | '{}'              | بيانات إضافية (tags, owner, version, custom filters...)           |
| created_at    | DATETIME      | نعم   | CURRENT_TIMESTAMP | تاريخ الإنشاء                                                     |
| updated_at    | DATETIME      | نعم   | ON UPDATE         | آخر تحديث                                                         |

**فهارس مقترحة:**
```sql
INDEX idx_name (name(100))
INDEX idx_public (is_public)